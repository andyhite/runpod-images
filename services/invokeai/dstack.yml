type: service
name: invokeai

# Use the InvokeAI Docker image
image: andyhite/invokeai:latest

# Ports for the service
ports:
  - "9090"  # InvokeAI web interface
  - "22"    # SSH access

# Environment variables
env:
  - PUBLIC_KEY=${PUBLIC_KEY}
  - HF_TOKEN=${HF_TOKEN}
  - INVOKEAI_REMOTE_API_TOKENS=${INVOKEAI_REMOTE_API_TOKENS}

# Resource requirements optimized for InvokeAI
resources:
  gpu:
    name: "L40S"
    memory: "48GB"
  cpu: 8..
  memory: 32GB..
  disk: 100GB..

# Volume mounts for persistent storage
volumes:
  - /workspace:/workspace

# Start InvokeAI web interface
commands:
  - invokeai-web
